const _0x255847=_0x2e73;(function(_0x543a02,_0x2de2cb){const _0x496e6d=_0x2e73,_0x51170c=_0x543a02();while(!![]){try{const _0x1586fe=-parseInt(_0x496e6d(0xe1))/0x1*(-parseInt(_0x496e6d(0xf1))/0x2)+-parseInt(_0x496e6d(0xdb))/0x3+parseInt(_0x496e6d(0xd3))/0x4*(-parseInt(_0x496e6d(0xd2))/0x5)+parseInt(_0x496e6d(0xd7))/0x6*(-parseInt(_0x496e6d(0xc6))/0x7)+-parseInt(_0x496e6d(0xad))/0x8+-parseInt(_0x496e6d(0xca))/0x9+parseInt(_0x496e6d(0xcc))/0xa;if(_0x1586fe===_0x2de2cb)break;else _0x51170c['push'](_0x51170c['shift']());}catch(_0x321f72){_0x51170c['push'](_0x51170c['shift']());}}}(_0x185b,0xcbbb3));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js';const firebaseConfig={'apiKey':_0x255847(0xe8),'authDomain':_0x255847(0xf0),'projectId':_0x255847(0xc8),'storageBucket':'cpprog03.appspot.com','messagingSenderId':_0x255847(0xbb),'appId':_0x255847(0xcf)};import{getFirestore,doc,getDoc,collection,addDoc,setDoc,updateDoc,deleteDoc,deleteField,onSnapshot}from'https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js';function _0x185b(){const _0xcaf790=['COMLAB-ATTENDANCE-TABLE','data','complete','stud-name','myqrcode','value','getMinutes','log','This\x20Pc\x20is\x20occupied!','Occupied','Occupied!\x20<br>\x20BUT\x20LATE!','316552887176','false','forEach','my-qr-reader','split','stud-id','Data\x20Save\x20Successfully','onload','B1-28_DESKTOPPCNUMBER-','background-color:\x20lightgreen;','innerHTML','665swapud','remove','cpprog03','push','13957929RZtNYP','</span>','59204830exDmrX','style','click','1:316552887176:web:2d8b0fc17477132873d83d','Please\x20fill\x20all\x20the\x20requirements!','background-color:\x20yellow;\x20padding:10px;\x20color:\x20navy;','5YGNQpc','4652636ueBIYR','add','course-name','initializeApp','43932ljFPjI','readyState','display:\x20block;','collection','3298104vaEbtC','show','target','Scan\x20Successfully','Com_Unit_Num','true','67141ZJvpYN','interactive','close_form','working','firestore','slice','Status','AIzaSyCOB2qEHCqj4ogZdjIH4Ff-tl-StyLShOk','getMonth','web-form','getElementsByTagName','You\x20scanned\x20','reload','size','render','cpprog03.firebaseapp.com','20aeAHeQ','display:\x20none;','attendance\x20and\x20log\x20in\x20will\x20cancel','sect-name','Desk','SchoolOnTime','background-color:\x20lightgreen;\x20padding:\x2010px;','getElementById','length','DOMContentLoaded','SOME-IS-TYPING','classList','9987296pmnCSK','addEventListener','getDate'];_0x185b=function(){return _0xcaf790;};return _0x185b();}const app=initializeApp(firebaseConfig);firebase[_0x255847(0xd6)](firebaseConfig);const db=firebase[_0x255847(0xe5)](),client=getFirestore();let deskStat=[],studeData,count,Tablecells,Late;const close_form=document[_0x255847(0xf8)](_0x255847(0xe3));function _0x2e73(_0x2ef681,_0x350554){const _0x185bdf=_0x185b();return _0x2e73=function(_0x2e7357,_0x589e45){_0x2e7357=_0x2e7357-0xaa;let _0x4920a0=_0x185bdf[_0x2e7357];return _0x4920a0;},_0x2e73(_0x2ef681,_0x350554);}let qrbtn=document[_0x255847(0xf8)]('qr-btn');const stid=document['getElementById'](_0x255847(0xc0)),stname=document[_0x255847(0xf8)](_0x255847(0xb3)),stsec=document[_0x255847(0xf8)](_0x255847(0xf4)),courseName=document['getElementById'](_0x255847(0xd5)),save_btn=document['getElementById']('save_btn'),tname=document['getElementById']('teacher-name');async function checkSit(){const _0x229228=_0x255847;db[_0x229228(0xda)]('COMLAB-ATTENDANCE-TABLE')['onSnapshot'](_0x5f2810=>{_0x5f2810['forEach'](_0x407375=>{const _0x231a5e=_0x2e73;studeData=_0x407375[_0x231a5e(0xb1)]();const _0x4377d9=_0x407375['id'];deskStat[_0x231a5e(0xc9)]({...studeData,'dataID':_0x4377d9}),deskStat['forEach'](_0x5dd788=>{const _0x52f3d6=_0x231a5e;if(_0x5dd788[_0x52f3d6(0xe7)]===_0x52f3d6(0xb9)&&_0x5dd788['SchoolOnTime']===_0x52f3d6(0xe0)){const _0x3130f0=document[_0x52f3d6(0xeb)]('td');_0x3130f0[_0x5dd788[_0x52f3d6(0xf5)]][_0x52f3d6(0xcd)]=_0x52f3d6(0xd1),_0x3130f0[_0x5dd788['Desk']][_0x52f3d6(0xc5)]='<span\x20class=\x22desk\x22>'+_0x5dd788[_0x52f3d6(0xdf)]+_0x52f3d6(0xcb)+_0x52f3d6(0xba);}else{if(_0x5dd788[_0x52f3d6(0xe7)]===_0x52f3d6(0xb9)&&_0x5dd788[_0x52f3d6(0xf6)]===_0x52f3d6(0xbc)){const _0x5567a9=document[_0x52f3d6(0xeb)]('td');_0x5567a9[_0x5dd788[_0x52f3d6(0xf5)]][_0x52f3d6(0xcd)]='background-color:\x20red;\x20padding:10px;',_0x5567a9[_0x5dd788[_0x52f3d6(0xf5)]][_0x52f3d6(0xc5)]='<span\x20class=\x22desk\x22>'+_0x5dd788[_0x52f3d6(0xdf)]+_0x52f3d6(0xcb)+'Occupied!\x20<br>\x20Ontime';}else{const _0x329d23=document[_0x52f3d6(0xeb)]('td');_0x329d23[_0x5dd788[_0x52f3d6(0xf5)]][_0x52f3d6(0xcd)]=_0x52f3d6(0xc4);}}});});});}document[_0x255847(0xae)](_0x255847(0xaa),function(){const _0x4b47e9=_0x255847;let _0x3c5cf1=document['getElementsByTagName']('td');for(let _0x39ab56=0x0;_0x39ab56<_0x3c5cf1[_0x4b47e9(0xf9)];_0x39ab56++){(function(_0x26d870){const _0x1db839=_0x4b47e9;_0x3c5cf1[_0x26d870][_0x1db839(0xae)]('click',function(){const _0x522d6b=_0x1db839;_0x3c5cf1[_0x26d870]['innerHTML']!==''?alert(_0x522d6b(0xb8)):(getDateHour(),Tablecells=_0x26d870,Takepc(),document[_0x522d6b(0xf8)](_0x522d6b(0xea))['style']=_0x522d6b(0xd9));});}(_0x39ab56));}});let pcnumber=_0x255847(0xc3)+Tablecells,ToDeleteDoc;async function Takepc(){const _0x43580d=_0x255847,_0x4b5878=Tablecells;pcnumber='B1-28_DESKTOPPCNUMBER-'+Tablecells,ToDeleteDoc=doc(client,_0x43580d(0xab),pcnumber),setDoc(ToDeleteDoc,{'Desk':_0x4b5878});}async function ToSaveData(){const _0x5141ae=_0x255847,_0x31396c=Tablecells+0x1;pcnumber=_0x5141ae(0xc3)+Tablecells,console[_0x5141ae(0xb7)](pcnumber);var _0x6c75c0=doc(client,_0x5141ae(0xb0),pcnumber);setDoc(_0x6c75c0,{'Desk':Tablecells,'Status':_0x5141ae(0xb9),'Student_ID':stid[_0x5141ae(0xb5)],'Student_Name':stname['value'],'Student_Section':stsec[_0x5141ae(0xb5)],'Student_Course':courseName[_0x5141ae(0xb5)],'Teacher_Name':tname['value'],'Com_Unit_Num':_0x31396c,'SchoolOnTime':Late,'Date_Scan':getDateHour()});}close_form[_0x255847(0xae)](_0x255847(0xce),async function(){const _0x4bd317=_0x255847;await deleteDoc(ToDeleteDoc),TypingCheckStudent(),setInterval(function(){const _0x110deb=_0x2e73;location[_0x110deb(0xed)]();},0x1388),document[_0x4bd317(0xf8)](_0x4bd317(0xea))[_0x4bd317(0xcd)]=_0x4bd317(0xf2);}),save_btn[_0x255847(0xae)](_0x255847(0xce),async function(){const _0x4db6ed=_0x255847;await deleteDoc(ToDeleteDoc),ToSaveData(),alert(_0x4db6ed(0xc1)),document[_0x4db6ed(0xf8)](_0x4db6ed(0xea))[_0x4db6ed(0xcd)]='display:\x20none;',setInterval(function(){const _0x39169c=_0x4db6ed;location[_0x39169c(0xed)]();},0x1388);}),qrbtn[_0x255847(0xae)](_0x255847(0xce),function(){const _0x7828a4=_0x255847;getDateHour();if(stid[_0x7828a4(0xb5)]===''||stname[_0x7828a4(0xb5)]===''||stsec[_0x7828a4(0xb5)]===''||courseName[_0x7828a4(0xb5)]==='')alert(_0x7828a4(0xd0));else{if(Late==='not\x20Allow')alert(_0x7828a4(0xf3));else{myqrcode[_0x7828a4(0xac)][_0x7828a4(0xd4)](_0x7828a4(0xdc)),document['getElementById'](_0x7828a4(0xb4))[_0x7828a4(0xcd)]='display:\x20block;';function _0x10685f(_0x1ffe4f){const _0x255232=_0x7828a4;document[_0x255232(0xd8)]===_0x255232(0xb2)||document[_0x255232(0xd8)]===_0x255232(0xe2)?setTimeout(_0x1ffe4f,0x1):document[_0x255232(0xae)](_0x255232(0xaa),_0x1ffe4f);}_0x10685f(function(){const _0x18bb08=_0x7828a4;var _0x45d076=document[_0x18bb08(0xf8)]('you-qr-result'),_0x3e8a06,_0x5aaeed=0x0;function _0x216c31(_0x95a2f2,_0x3fa784){const _0x12243c=_0x18bb08;if(_0x95a2f2!==_0x3e8a06){++_0x5aaeed,_0x3e8a06=_0x95a2f2;let _0x18dedf=_0x95a2f2,_0xf0965d;const _0x20d94b=_0x18dedf[_0x12243c(0xbf)](',');_0x18dedf=_0x20d94b[0x1];const _0x4f679b=_0x20d94b[0x2],_0x18100c=_0x20d94b[0x3];createData(_0x18dedf,_0x4f679b,_0x18100c),myqrcode[_0x12243c(0xac)][_0x12243c(0xc7)](_0x12243c(0xdc)),document[_0x12243c(0xf8)]('myqrcode')['style']=_0x12243c(0xf2),alert(_0x12243c(0xde)),_0x45d076[_0x12243c(0xc5)]=_0x12243c(0xec)+_0x95a2f2;}}var _0x1bf5d6=new Html5QrcodeScanner(_0x18bb08(0xbe),{'fps':0xa,'qrbox':0xfa});_0x1bf5d6[_0x18bb08(0xef)](_0x216c31);});}}});async function createData(_0x5f036f,_0x260fde,_0x4df3c1){const _0x3e4019=_0x255847;var _0x50d175=doc(client,_0x3e4019(0xb0),_0x5f036f);setDoc(_0x50d175,{'Desk':_0x260fde,'Status':_0x3e4019(0xb9),'Student_ID':stid['value'],'Student_Name':stname[_0x3e4019(0xb5)],'Student_Section':stsec[_0x3e4019(0xb5)],'Student_Course':courseName[_0x3e4019(0xb5)],'Teacher_Name':tname['value'],'Com_Unit_Num':_0x4df3c1,'SchoolOnTime':Late,'Date_Scan':getDateHour()});}closecamera[_0x255847(0xae)](_0x255847(0xce),function(){const _0x2959c7=_0x255847;myqrcode['classList'][_0x2959c7(0xc7)](_0x2959c7(0xdc)),document[_0x2959c7(0xf8)](_0x2959c7(0xb4))[_0x2959c7(0xcd)]=_0x2959c7(0xf2);}),window['addEventListener'](_0x255847(0xce),function(_0x24d51a){const _0x74c2d7=_0x255847;_0x24d51a[_0x74c2d7(0xdd)]==myqrcode&&myqrcode[_0x74c2d7(0xac)][_0x74c2d7(0xc7)](_0x74c2d7(0xdc));}),closePopup[_0x255847(0xae)](_0x255847(0xce),function(){const _0xc1a0d8=_0x255847;myPopup[_0xc1a0d8(0xac)]['remove'](_0xc1a0d8(0xdc));}),window[_0x255847(0xae)](_0x255847(0xce),function(_0x3792b4){const _0x25540a=_0x255847;_0x3792b4['target']==myPopup&&myPopup[_0x25540a(0xac)][_0x25540a(0xc7)](_0x25540a(0xdc));});function getDateHour(){const _0x487e88=_0x255847;let _0x5c125c=new Date(),_0x28de2e=_0x5c125c['getHours'](),_0x4219d9=_0x5c125c[_0x487e88(0xb6)](),_0x2a8f38=_0x28de2e>=0xc?'pm':'am';_0x28de2e=_0x28de2e%0xc,_0x28de2e=_0x28de2e?_0x28de2e:0xc,_0x4219d9=_0x4219d9<0xa?'0'+_0x4219d9:_0x4219d9;let _0x107882=_0x28de2e+':'+_0x4219d9+_0x2a8f38,_0x3c5a6d=('0'+_0x5c125c[_0x487e88(0xaf)]())[_0x487e88(0xe6)](-0x2),_0x46f2f1=('0'+(_0x5c125c[_0x487e88(0xe9)]()+0x1))[_0x487e88(0xe6)](-0x2),_0x4db264=_0x5c125c['getFullYear'](),_0x49ebdb=_0x46f2f1+'/'+_0x3c5a6d+'/'+_0x4db264,_0x36a93b=_0x107882+'\x20'+_0x49ebdb;if(_0x5c125c[_0x487e88(0xb6)]()>0x14)Late=_0x487e88(0xe0);else _0x5c125c[_0x487e88(0xb6)]()>0x28?Late='not\x20Allow':Late='false';return _0x36a93b;}async function TypingCheckStudent(){const _0x2d8d5b=_0x255847;let _0x3861fe=0x0;db['collection'](_0x2d8d5b(0xab))['onSnapshot'](_0x4b4d0b=>{const _0x47a02c=_0x2d8d5b;_0x4b4d0b[_0x47a02c(0xbd)](_0xafdf78=>{const _0x2f59ce=_0x47a02c,_0x517768=_0xafdf78[_0x2f59ce(0xb1)]()[_0x2f59ce(0xf5)],_0xc2e26e=document[_0x2f59ce(0xeb)]('td');_0xc2e26e[_0x517768]['style']='background-color:\x20purple;\x20padding:\x2010px;\x20',_0x3861fe=_0x517768;});if(_0x4b4d0b[_0x47a02c(0xee)]===0x0){console[_0x47a02c(0xb7)](_0x47a02c(0xe4));const _0x424bec=document[_0x47a02c(0xeb)]('td');_0x424bec[_0x3861fe][_0x47a02c(0xcd)]=_0x47a02c(0xf7);}});}window[_0x255847(0xc2)]=function(){TypingCheckStudent(),checkSit();};
